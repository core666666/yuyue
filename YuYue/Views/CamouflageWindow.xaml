<Window x:Class="YuYue.Views.CamouflageWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="工作文档"
        Height="720"
        Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowStyle="SingleBorderWindow">

    <Grid Background="#F7F9FC">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 顶部提示栏 -->
        <Border Grid.Row="0" Background="#3498DB" Padding="12,8">
            <Grid>
                <TextBlock Text="{Binding CamouflageStatus}" 
                           Foreground="White" 
                           FontSize="14"
                           VerticalAlignment="Center"/>
                <TextBlock Text="按 F12 返回阅读 | Ctrl+Tab 切换伪装" 
                           Foreground="White" 
                           FontSize="12"
                           Opacity="0.8"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- 伪装内容区域 -->
        <Grid Grid.Row="1" Margin="24">
            <!-- 代码编辑器伪装 -->
            <Grid x:Name="CodeCamouflage">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedCamouflage.Key}" Value="code">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid.RowDefinitions>
                    <RowDefinition Height="42"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" Background="#2D2D2D" CornerRadius="4,4,0,0">
                    <StackPanel Orientation="Horizontal" Margin="12,0" VerticalAlignment="Center">
                        <Ellipse Fill="#FF5F56" Width="10" Height="10" Margin="0,0,6,0"/>
                        <Ellipse Fill="#FFBD2E" Width="10" Height="10" Margin="0,0,6,0"/>
                        <Ellipse Fill="#27C93F" Width="10" Height="10"/>
                        <TextBlock Text="  main.cs - Visual Studio Code" 
                                   Foreground="#CCCCCC" 
                                   FontSize="13"
                                   Margin="16,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Border Grid.Row="1" Background="#1E1E1E" CornerRadius="0,0,4,4">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <TextBlock Margin="16" 
                                   FontFamily="Consolas" 
                                   FontSize="14" 
                                   Foreground="#D4D4D4"
                                   xml:space="preserve"><Run Foreground="#569CD6">using</Run> System;
<Run Foreground="#569CD6">using</Run> System.Collections.Generic;
<Run Foreground="#569CD6">using</Run> System.Linq;

<Run Foreground="#569CD6">namespace</Run> <Run Foreground="#4EC9B0">BusinessLogic</Run>
{
    <Run Foreground="#569CD6">public</Run> <Run Foreground="#569CD6">class</Run> <Run Foreground="#4EC9B0">DataProcessor</Run>
    {
        <Run Foreground="#569CD6">private</Run> <Run Foreground="#569CD6">readonly</Run> <Run Foreground="#4EC9B0">ILogger</Run> _logger;
        
        <Run Foreground="#569CD6">public</Run> <Run Foreground="#DCDCAA">DataProcessor</Run>(<Run Foreground="#4EC9B0">ILogger</Run> logger)
        {
            _logger = logger;
        }
        
        <Run Foreground="#569CD6">public</Run> <Run Foreground="#569CD6">async</Run> <Run Foreground="#4EC9B0">Task</Run>&lt;<Run Foreground="#4EC9B0">List</Run>&lt;<Run Foreground="#4EC9B0">Report</Run>&gt;&gt; <Run Foreground="#DCDCAA">ProcessDataAsync</Run>()
        {
            <Run Foreground="#569CD6">var</Run> results = <Run Foreground="#569CD6">new</Run> <Run Foreground="#4EC9B0">List</Run>&lt;<Run Foreground="#4EC9B0">Report</Run>&gt;();
            
            <Run Foreground="#C586C0">try</Run>
            {
                _logger.<Run Foreground="#DCDCAA">LogInformation</Run>(<Run Foreground="#CE9178">"开始处理数据..."</Run>);
                
                <Run Foreground="#C586C0">for</Run> (<Run Foreground="#569CD6">int</Run> i = <Run Foreground="#B5CEA8">0</Run>; i &lt; <Run Foreground="#B5CEA8">100</Run>; i++)
                {
                    <Run Foreground="#569CD6">var</Run> report = <Run Foreground="#569CD6">await</Run> <Run Foreground="#DCDCAA">GenerateReportAsync</Run>(i);
                    results.<Run Foreground="#DCDCAA">Add</Run>(report);
                }
                
                _logger.<Run Foreground="#DCDCAA">LogInformation</Run>(<Run Foreground="#CE9178">$"处理完成，共 {results.Count} 条记录"</Run>);
            }
            <Run Foreground="#C586C0">catch</Run> (<Run Foreground="#4EC9B0">Exception</Run> ex)
            {
                _logger.<Run Foreground="#DCDCAA">LogError</Run>(ex, <Run Foreground="#CE9178">"数据处理失败"</Run>);
                <Run Foreground="#C586C0">throw</Run>;
            }
            
            <Run Foreground="#C586C0">return</Run> results;
        }
    }
}</TextBlock>
                    </ScrollViewer>
                </Border>
            </Grid>

            <!-- Excel 表格伪装 -->
            <Grid x:Name="ExcelCamouflage">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedCamouflage.Key}" Value="excel">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Border Background="White" BorderBrush="#D0D0D0" BorderThickness="1">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <Border Grid.Row="0" Background="#F0F0F0" BorderBrush="#D0D0D0" BorderThickness="0,0,0,1" Padding="8">
                            <TextBlock Text="销售数据分析表.xlsx - Excel" FontWeight="SemiBold"/>
                        </Border>
                        
                        <DataGrid Grid.Row="1" 
                                  x:Name="ExcelDataGrid"
                                  AutoGenerateColumns="False"
                                  HeadersVisibility="All"
                                  GridLinesVisibility="All"
                                  CanUserAddRows="False"
                                  IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="日期" Width="120" Binding="{Binding Date}"/>
                                <DataGridTextColumn Header="产品名称" Width="200" Binding="{Binding Product}"/>
                                <DataGridTextColumn Header="销售额" Width="120" Binding="{Binding Sales}"/>
                                <DataGridTextColumn Header="成本" Width="120" Binding="{Binding Cost}"/>
                                <DataGridTextColumn Header="利润" Width="120" Binding="{Binding Profit}"/>
                                <DataGridTextColumn Header="增长率" Width="100" Binding="{Binding Growth}"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>

            <!-- 浏览器伪装 -->
            <Grid x:Name="BrowserCamouflage">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedCamouflage.Key}" Value="browser">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <Border Grid.Row="0" Background="#F0F0F0" BorderBrush="#D0D0D0" BorderThickness="0,0,0,1" Padding="12,8">
                    <Grid>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="← → ⟳" FontSize="16" Margin="0,0,12,0"/>
                            <Border Background="White" BorderBrush="#D0D0D0" BorderThickness="1" 
                                    CornerRadius="4" Padding="8,4" Width="600">
                                <TextBlock Text="https://docs.microsoft.com/zh-cn/dotnet/csharp/" 
                                           Foreground="#666"/>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <ScrollViewer Grid.Row="1" Background="White" Padding="40,20">
                    <StackPanel>
                        <TextBlock Text="C# 文档" FontSize="32" FontWeight="Bold" Margin="0,0,0,20"/>
                        <TextBlock Text="欢迎使用 C# 文档" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,12"/>
                        <TextBlock TextWrapping="Wrap" FontSize="14" LineHeight="24" Margin="0,0,0,20">
                            C# 是一种新式编程语言，不仅面向对象，还类型安全。开发人员利用 C# 能够生成在 .NET 中运行的多种安全可靠的应用程序。
                        </TextBlock>
                        <TextBlock Text="入门" FontSize="18" FontWeight="SemiBold" Margin="0,20,0,12"/>
                        <TextBlock TextWrapping="Wrap" FontSize="14" LineHeight="24">
                            • 安装 Visual Studio 或 Visual Studio Code<LineBreak/>
                            • 创建第一个 C# 应用程序<LineBreak/>
                            • 了解 C# 语法基础<LineBreak/>
                            • 探索面向对象编程概念
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</Window>
